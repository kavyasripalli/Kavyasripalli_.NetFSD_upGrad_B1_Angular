<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Location-Based Weather Logger</title>
</head>
<body onload="loadHistory()">

    <h1>Location Logger</h1>

    <button onclick="getLocation()">Get My Location</button>

    <h3>Current Location</h3>
    <p id="currentLocation"></p>

    <h3>Location History (Last 5)</h3>
    <div id="history"></div>

    <script>

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                document.getElementById("currentLocation").textContent = "Geolocation not supported.";
            }
        }

        function showPosition(position) {
            let latitude = position.coords.latitude;
            let longitude = position.coords.longitude;

            document.getElementById("currentLocation").textContent =
                "Latitude: " + latitude + " , Longitude: " + longitude;

            let locationEntry = {
                lat: latitude,
                lon: longitude,
                time: new Date().toLocaleString()
            };

            let history = JSON.parse(localStorage.getItem("locationHistory")) || [];

            history.push(locationEntry);

            if (history.length > 5) {
                history.shift();
            }

            localStorage.setItem("locationHistory", JSON.stringify(history));

            displayHistory(history);
        }

        function showError(error) {
            let message = "";

            switch (error.code) {
                case error.PERMISSION_DENIED:
                    message = "Permission denied by user.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    message = "Location information unavailable.";
                    break;
                case error.TIMEOUT:
                    message = "Location request timed out.";
                    break;
                default:
                    message = "An unknown error occurred.";
            }

            document.getElementById("currentLocation").textContent = message;
        }

        function loadHistory() {
            let history = JSON.parse(localStorage.getItem("locationHistory")) || [];
            displayHistory(history);
        }

        function displayHistory(historyArray) {
            let historyDiv = document.getElementById("history");
            historyDiv.innerHTML = "";

            for (let i = 0; i < historyArray.length; i++) {
                let entry = historyArray[i];
                historyDiv.innerHTML +=
                    "<p>Lat: " + entry.lat +
                    " , Lon: " + entry.lon +
                    " , Time: " + entry.time + "</p>";
            }
        }

    </script>

</body>
</html>